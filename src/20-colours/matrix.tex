\section{Macierz i~wyznacznik} % (fold)
\label{sec:colour_matrix}
Zajmiemy się teraz wyznacznikiem, pierwszym nieoczywistym niezmiennikiem splotów, który przypisuje każdemu pewną liczbę całkowitą.
Jest on blisko związany z~kolorowaniem.
Zauważmy, że pierwszy ruch Reidemeistera usuwa zamknięte krzywe, czyli pojedyncze łuki bez skrzyżowań.
Diagram bez takich krzywych ma tyle samo skrzyżowań, co łuków.

\begin{definition}[macierz kolorująca]
    \index{macierz!kolorująca}
    Ustalmy diagram bez zamkniętych krzywych dla splotu $L$ z~łukami $x_0, \ldots, x_m$ oraz skrzyżowaniami $0, \ldots, m$.
    Definiujemy macierz $A_+$, której wyraz $a_{lj}$ jest współczynnikiem przy $x_j$ w~$l$-tym równaniu kolorującym:
\begin{comment}
    \[\begin{tikzpicture}[baseline=-0.65ex, scale=0.12]
    \useasboundingbox (-5, -10) rectangle (5,5);
    \begin{knot}[clip width=5, end tolerance=1pt, flip crossing/.list={1}]
        \strand[semithick] (-5,5) to (5,-5);
        \strand[semithick] (-5,-5) to (5,5);
        \node[darkblue] at (5, 5)[below right] {$x_i$};
        \node[darkblue] at (5, -5)[above right] {$x_j$};
        \node[darkblue] at (-5, 5)[below left] {$x_k$};
        \node[black] at (0, -7)[below] {$x_j+x_k - 2x_i \equiv 0 \mod n$};
    \end{knot}
    \end{tikzpicture}\]
\end{comment}
    Macierz kolorująca $A$ powstaje z~macierzy $A_+$ przez skreślenie dowolnego wiersza i~kolumny.
\end{definition}

Taka macierz jest kwadratowa, ponieważ z~każdego skrzyżowania wychodzą (tunelem) dwa włókna mające dwa końce.
Wykreślenie wiersza i~kolumny jest konieczne.
Gdybyśmy tego zaniechali, otrzymana macierz nie byłaby odwracalna, bowiem wiersze sumują się do zera (patrz fakt \ref{prp:colouring_sum_zero}).
Dla alternujących diagramów możemy żądać, by górą $i$-tego skrzyżowania biegło $i$-te włókno, wtedy na diagonali macierzy $A$ znajdą się same minus dwójki.

\begin{definition}[wyznacznik]
    \index{wyznacznik}
    \label{def:determinant}
    Wyznacznikiem splotu nazywamy wyznacznik macierzy kolorującej $A$ bez znaku: $\det K := |\det A_K|$.
    Za wyznacznik niewęzła przyjmujemy liczbę $1$.
\end{definition}

\begin{definition}[defekt]
    Wymiar jądra macierzy kolorującej modulo $p$, defekt, nazywamy defektem węzła.
\end{definition}

Defekty modulo różne liczby pierwsze są niezależne od siebie.
Na przykład suma spójna $k$ trójlistników i~$j$ węzłów $T_{2,5}$ posiada defekt $k$ modulo $3$ oraz $j$ modulo $5$.
Podobne przykłady istnieją dla innych zbiorów liczb pierwszych.

Pokażemy później (po poznaniu grupy kolorującej, czyli we wniosku \ref{det_invariant}) lub jeszcze później (po wprowadzeniu wielomianu Alexandera, w~dowodzie faktu \ref{alexander_invariance}), że wyznacznik splotu jest dobrze określony: nie zależy on od wyboru etykietowania, minora macierzy oraz diagramu i~że jest niezmiennikiem.
Teraz ograniczymy się do jego kilku własności.

Defekt także jest niezmiennikiem, choć rzadziej używanym.
Węzeł o~defekcie $n$ modulo $p$ posiada $p(p^n-1)$ kolorowań $p$ kolorami.
Węzły $8_{18}$ oraz $9_{24}$ mają ten sam wyznacznik, $45$.
Ich defekty modulo $3$ to $1$ i~$2$, zatem są różne.

% Każde $p$-kolorowanie węzła $n$-mostowego jest wyznaczone przez kolory $n$ mostów
% % To brzmi podejrzanie: więc przestrzeń kolorowań ma wymiar co najwyżej $n$ i~defekt modulo $p$ nie przekracza $\operatorname{br} - 1$.
% Wnioskujemy stąd, że $(3,3,3)$-precel nie jest dwumostowy.

% \begin{proof}
%     \emph{Krok pierwszy}.
%     Pokażemy, że żaden ruch Reidemeistera nie zmienia wyznacznika.
%     \begin{enumerate}
%         \item \emph{Ruch $R_1$}. Diagram przed lub po ruchu zawiera co najmniej jedno włókno, które łączy tunel z~mostem pewnego skrzyżowania.
%         \item \emph{Ruch $R_2$}.
%         \item \emph{Ruch $R_3$}.
%     \end{enumerate}

%     \emph{Krok drugi}.
%     Niech $A_{i,j}$ oznacza minor powstały przez skreślenie $i$-tego wiersza oraz $j$-tej kolumny.
%     Pokażemy, że wartość wyznacznika nie zależy od wyboru $i$ oraz $j$.

%     Niech $X$ będzie macierzą $k \times k$ złożoną z~samych jedynek.
%     Suma elementów w~każdej kolumnie oraz każdym wierszu macierzy $A + X$ wynosi $k$, ponieważ znaki równań zostały dobrze wybrane.
%     Wykonujemy kolejno operacje:
%     \begin{enumerate}
%         \item Dodajemy do $i$-tego wiersza sumę pozostałych.
%         \item Dodajemy do $j$-tej kolumny sumę pozostałych.
%         Teraz $i$-ty wiersz oraz $j$-ta kolumna zawierają wyrazy $k$ z~wyjątkiem $a_{ij}$, który wynosi $k^2$.
%         \item Wyciągamy $k$ z~$i$-tego wiersza przed wyznacznik.
%         \item Odejmujemy $i$-ty wiersz od pozostałych.
%     \end{enumerate}
%     Rozwinięcie Laplace'a względem $j$-tej kolumny mówi, że $|\det (A+X)| = k^2 |(-1)^{i+j} \det A_{i,j}|$, co kończy dowód drugiego kroku.

%     \emph{Krok trzeci}.
%     Pokażemy, że zmiana etykietowania nie zmienia wyznacznika.
% \end{proof}

Wyznacznik jest blisko związany z kolorowaniami.

\begin{lemma}
    Niech $A$ będzie macierzą $r \times r$ o całkowitych wyrazach.
    Istnieje niezerowy wektor $x \in (\Z/n\Z)^r$ taki, że $Ax \equiv 0 \mod n$ wtedy i tylko wtedy, gdy liczby $\det A$ oraz $n$ nie są względnie pierwsze.
\end{lemma}

\begin{proof}
    Z~algebry liniowej wiemy, że dla pewnych odwracalnych całkowitoliczbowych macierzy $C, R$ macierz $RAC = diag(a_1, \ldots, a_m)$ jest diagonalna: to postać normalna Smitha.
    Istnieje odpowiedniość między niezerowymi rozwiązanami równania $Ax \equiv 0$ oraz $Dy \equiv 0$, mamy bowiem $x \equiv Cy$, zatem bez straty ogólności możemy przyjąć, że macierz $A$ jest diagonalna.

    Istnieje niezerowy wektor $x$ taki, że $Ax \equiv 0 \mod n$ wtedy i tylko wtedy, jeśli istnieją $x_1, \ldots, x_m \in \Z/n\Z$, nie wszystkie zerowe, że dla każdego $i$ mamy $a_ix_i \equiv 0 \mod n$.
    Oznacza to, że dla pewnego $i$ liczby $a_i, n$ nie są względnie pierwsze.
    Macierz $A$ jest diagonalna, więc jej wyznacznik ma postać $\det A = \pm |a_1| \cdot \ldots \cdot |a_m|$.
    Wnioskujemy stąd, że liczby $\det A, n$ także nie są względnie pierwsze.
\end{proof}

\begin{proposition}
    \label{prp:colour_det}
    Splot $L$ koloruje się modulo $n$ wtedy i~tylko wtedy, gdy liczby $\det L$ oraz $n$ nie są względnie pierwsze.
\end{proposition}

\begin{proof}
    Wybierzmy diagram dla splotu $L$ z uporządkowanymi łukami i skrzyżowaniami.
    Bez straty ogólności ograniczmy się do tych kolorowań, gdzie $x_0 = 0$.
    Kolorowanie modulo $n$ istnieje dokładnie wtedy, gdy istnieje niezerowy wektor $(x_1, x_2, \ldots, x_m)$ taki, że $Ax \equiv 0 \mod n$.
    Na mocy lematu oraz definicji $\det L = |\det A|$, dowód zostaje zakończony.
\end{proof}

\begin{corollary}
    Niech $L$ będzie takim splotem, że $\det L = 1$.
    Wtedy splot $L$ nie koloruje się modulo $n$ dla żadnego naturalnego $n$.
\end{corollary}

O takich splotach czasami, choć rzadko, mówi się, że są niewidzialne.

\begin{corollary}
    Niech $L$ będzie takim splotem, że $\det L = 0$.
    Wtedy splot $L$ koloruje się modulo $n$ dla każdego naturalnego $n$.
\end{corollary}

\begin{corollary}
    Jeśli splot $L$ jest rozszczepialny, to jego wyznacznik wynosi $0$.
\end{corollary}

Istnieje jeszcze jedna kombinatoryczna metoda badania węzłów, która prowadzi między innymi do pojęcia wyznacznika.
W latach 30. ubiegłego wieku L. Goeritz pokazał, jak diagram węzła wyznacza specjalną formę kwadratową.
Nieco później H. F. Trotter zmodyfikował jego pomysł, by sygnatura formy stanowiła niezmiennik splotów.
Gordon, Litherland ujednolicili dwa wyżej wymienione podejścia w~pracy \cite{litherland81}.
My opiszemy krótko macierz Goeritza.

Ustalmy szachowiony diagram $D$ dla splotu $L$.
Oznaczmy białe obszary $0, 1, \ldots, m$, przy czym $0$ jest obszarem nieograniczonym.
Przydzielmy skrzyżowaniom znaki:
\begin{comment}
    \[\begin{tikzpicture}[baseline=-0.65ex, scale=0.12]
    \useasboundingbox (-5, -5) rectangle (5,5);
    \begin{knot}[clip width=5, end tolerance=1pt, flip crossing/.list={1}]
        \strand[semithick] (-5,5) to (5,-5);
        \strand[semithick] (-5,-5) to (5,5);
        \fill[blue!20!white] (-4, 5) to (0, 1) to (4, 5);
        \fill[blue!20!white] (-4, -5) to (0, -1) to (4, -5);
        \node[darkblue] at (-5, 0) {$+1$};
    \end{knot}
    \end{tikzpicture}
    \quad\quad\quad
    \quad\quad\quad
    \begin{tikzpicture}[baseline=-0.65ex, scale=0.12]
    \useasboundingbox (-5, -5) rectangle (5,5);
    \begin{knot}[clip width=5, end tolerance=1pt]
        \strand[semithick] (-5,5) to (5,-5);
        \strand[semithick] (-5,-5) to (5,5);
        \fill[blue!20!white] (-4, 5) to (0, 1) to (4, 5);
        \fill[blue!20!white] (-4, -5) to (0, -1) to (4, -5);
        \node[darkblue] at (-5, 0) {$-1$};
    \end{knot}
    \end{tikzpicture}\]
\end{comment}

\begin{definition}
    \index{macierz!Goeritza}
    Macierz Goeritza powstaje przez skreślenie z~macierzy $G_+$ jednego wiersza oraz jednej kolumny:
    \[
        G_+=\begin{pmatrix}
        G_{00} & \cdots & G_{0m} \\
        \vdots & \ddots & \vdots \\
        G_{m0} & \cdots & G_{mm}
        \end{pmatrix},
    \]
    gdzie jeśli $i\neq j$, to $G_{ij}$ jest sumą znaków skrzyżowań przyległych do $i$ oraz $j$.
    Dla $i = j$, $G_{ii}$ jest minus sumą znaków skrzyżowań wokół $j$-tego obszaru.
\end{definition}

Macierz $G_+$ posiada dwie własności pozwalające wykryć proste błędy rachunkowe: jest symetryczna, a~jej kolumny i~wiersze sumują się do zera.
Jest przy tym zazwyczaj mniejsza od macierzy kolorującej.

\begin{proposition}
    Niech $K$ będzie ustalonym węzłem, $G$ jego macierzą Goeritza, zaś $A$ macierzą kolorującą.
    Z~dokładnością do znaku, obie macierze mają ten sam wyznacznik: $\det G = \pm \det A$.
\end{proposition}

Nie możemy niestety podać dowodu tego faktu, wymaga bowiem znajomości topologii algebraicznej, której wolelibyśmy nie zakładać.
Macierz Goeritza nie jest niezmiennikiem splotów.
Jeśli jednak równoważnym diagramom $D_1, D_2$ odpowiadają macierze $G_1, G_2$, to można między nimi przejść skończoną liczbą dwóch ruchów:
\begin{enumerate}[leftmargin=*]
\itemsep0em
    \item zamiany macierzy $G$ na $PGP^{-1}$, gdzie $P$ i~$P^{-1}$ mają całkowite wyrazy
    \item dopisania lub skreślenia $\pm 1$ na przekątnej (dla węzłów) albo $-1, 0, 1$ (dla splotów).
\end{enumerate}

% \begin{proposition}
%     Wyznacznik jest niezmiennikiem splotów.
%     Jeśli diagramy $D_1, D_2$ przedstawiają ten sam splot, to od macierzy Goeritza $G_1$ pierwszego do macierzy $G_2$ drugiego można dojść, wykonując trzy rodzaje ruchów:
%     \begin{enumerate}
%         \item zamieniając $G$ z~$P^t G P$, gdzie macierz $P$ jest całkowitoliczbowa i~$\det P = \pm 1$.
%         \item zamieniając $G$ z
%         \[
%             \begin{pmatrix}
%             G & 0 \\
%             0 & k
%             \end{pmatrix},
%         \]
%         gdzie $k \in \{-1, 0, 1\}$.
%         Dla węzłów można ograniczyć się do $k = \pm 1$.
%     \end{enumerate}
% \end{proposition}

% Dowód opiera się na prostych rachunkach i~ruchach Reidemeistera.

% Z macierzy Goeritza można otrzymać sygnaturę: $\sigma(G) - \mu$, gdzie $\mu$ to to suma znaków skrzyżowań o~odpowiednio dobranej orientacji.

Poniższy problem pochodzi od Stojmenowa.

\begin{conjecture}[problem 12.25 w \cite{ohtsuki02}]
    Niech $n$ będzie nieparzystą sumą dwóch kwadratów.
    Czy istnieje pierwszy, alternujący, achiralny węzeł o~wyznaczniku $n$?
\end{conjecture}

Oto, co już wiemy.
Dla $n = 1, 9, 49$ oraz być może pewnej liczby $n > 2000$ niebędącej kwadratem, taki węzeł nie istnieje.
Jeśli istnieje achiralny węzeł o wyznaczniku $n$, to $n$ jest nieparzystą sumą dwóch kwadratów (\cite{hartley79}).
Implikacja odwrotna także jest prawdziwa, od węzła można dodatkowo żądać bycia pierwszym lub alternującym, ale nie zawsze obydwu warunków jednocześnie.
Patrz też \cite{stoimenow05}.

\begin{proposition} \label{prp:bankwitz}
    Wyznacznik splotu alternującego $L$ jest nie mniejszy od jego indeksu skrzyżowaniowego: $\det L \ge \operatorname{cr} L$.
\end{proposition}

W ten sposób pokazano, że niealternujące węzły istnieją: $\det 8_{19} = 3 < 8 = \operatorname{cr} 8_{19}$.
Bankwitz podał w 1930 niepoprawny dowód dla specjalnego przypadku, kiedy $L$ jest węzłem.
Pierwszy pełny dowód, oparty o teorię grafów, przedstawił blisko trzy dekady później Crowell w \cite{crowell59}.
Znalazł też mocniejszą nierówność $\det L + 3 \ge \operatorname{cr} L$ dla pierwszych, alternujących splotów, które nie są $(2, n)$-torusowe.
To prawie wystarczyło do rozstrzygnięcia, które z węzłów o mniej niż 10 skrzyżowaniach są alternujące.
Otwartym problemem pozostały $9_{45}$, $9_{47}$, $9_{48}$ oraz $9_{49}$.

% Koniec sekcji Macierz i~wyznacznik
